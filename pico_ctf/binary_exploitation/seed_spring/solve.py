from pwn import *
import ctypes

i = -1e3

while i <= 0:
    ## get time sync epoch, the server program do this
    ## try to sync up with the server using a offset
    ## https://github.com/Naetw/CTF-pwn-tips#predictable-rngrandom-number-generator
    libc = ctypes.cdll.LoadLibrary ('/lib/x86_64-linux-gnu/libc.so.6')
    libc.srand (libc.time (0) + int (i))
    try:
        print ('For offset: %s' % (i))
        r = remote('jupiter.challenges.picoctf.org', 38462)
        lst = []
        for j in range (0, 30):
            lst.append (str (libc.rand () & 0xf))
        for j in range (1, 31):
            print ('Level %s, with rand: %s' % (j, lst [j - 1]))
            r.sendlineafter ('Guess the height: ', lst [j - 1])
        print (r.read ())
        break
    except Exception as e:
        print ('Failed: ' + str (KeyError (e)))
        i += 1
        continue

print (r.read ())
r.interactive ()
